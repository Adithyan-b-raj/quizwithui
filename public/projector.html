
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Projector - Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
      min-height: 100vh;
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .question-appear {
      animation: slideInDown 0.8s ease-out;
    }
    @keyframes slideInDown {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .option-item {
      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      animation: slideInLeft 0.6s ease-out;
      animation-fill-mode: both;
    }
    .option-item:nth-child(1) { animation-delay: 0.1s; }
    .option-item:nth-child(2) { animation-delay: 0.2s; }
    .option-item:nth-child(3) { animation-delay: 0.3s; }
    .option-item:nth-child(4) { animation-delay: 0.4s; }
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-50px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .scoreboard-card {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    .trophy-gold { color: #fbbf24; }
    .trophy-silver { color: #e5e7eb; }
    .trophy-bronze { color: #d97706; }
    .pulse-glow {
      animation: pulseGlow 2s infinite;
    }
    @keyframes pulseGlow {
      0%, 100% { box-shadow: 0 0 20px rgba(79, 70, 229, 0.3); }
      50% { box-shadow: 0 0 40px rgba(79, 70, 229, 0.6); }
    }
  </style>
</head>
<body class="p-8">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="glass-card rounded-3xl p-8 mb-8 shadow-2xl text-center">
      <h1 class="text-5xl font-bold text-gray-800 mb-2">üéØ Live Quiz</h1>
      <div class="flex items-center justify-center">
        <div class="w-3 h-3 bg-red-500 rounded-full mr-3 animate-pulse"></div>
        <p class="text-xl text-gray-600">Broadcasting Live</p>
      </div>
    </div>

    <div class="grid lg:grid-cols-3 gap-8">
      <!-- Question Section (2/3 width) -->
      <div class="lg:col-span-2">
        <!-- Question Card -->
        <div class="glass-card rounded-3xl p-12 shadow-2xl mb-8 pulse-glow">
          <div class="text-center">
            <div class="flex items-center justify-center mb-6">
              <div class="w-4 h-4 bg-purple-500 rounded-full mr-4"></div>
              <h2 class="text-2xl font-semibold text-gray-700">Current Question</h2>
            </div>
            <div id="questionText" class="text-4xl lg:text-5xl font-bold text-gray-800 leading-tight min-h-[8rem] flex items-center justify-center">
              <div class="flex items-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mr-4"></div>
                <span class="text-2xl">Waiting for question...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Options Section -->
        <div class="glass-card rounded-3xl p-8 shadow-2xl">
          <div class="flex items-center justify-center mb-8">
            <div class="w-4 h-4 bg-blue-500 rounded-full mr-4"></div>
            <h3 class="text-2xl font-semibold text-gray-700">Answer Options</h3>
          </div>
          <div id="optionsList" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="text-center py-12 text-gray-500 col-span-full">
              <div class="text-6xl mb-4">üí≠</div>
              <p class="text-xl">Options will appear here...</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Scoreboard Section (1/3 width) -->
      <div class="lg:col-span-1">
        <div class="glass-card rounded-3xl p-8 shadow-2xl sticky top-8">
          <div class="flex items-center justify-center mb-8">
            <div class="w-4 h-4 bg-yellow-500 rounded-full mr-4"></div>
            <h2 class="text-2xl font-semibold text-gray-700">üèÜ Leaderboard</h2>
          </div>
          <div id="scoreboardArea" class="space-y-4">
            <div class="text-center py-8 text-gray-500">
              <div class="text-4xl mb-4">üìä</div>
              <p class="text-lg">No scores yet.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const qText = document.getElementById("questionText");
    const opts = document.getElementById("optionsList");
    const sbArea = document.getElementById("scoreboardArea");

    socket.on("newQuestion", (q) => {
      // Add animation class
      qText.parentElement.classList.add("question-appear");
      
      // Update question
      qText.innerHTML = `<div class="flex items-center justify-center"><span class="text-6xl mr-6">‚ùì</span><span>${q.text}</span></div>`;
      
      // Update options with animations
      opts.innerHTML = "";
      q.options.forEach((option, index) => {
        const optionDiv = document.createElement("div");
        optionDiv.className = "option-item text-white font-bold text-xl lg:text-2xl p-6 rounded-2xl shadow-lg text-center";
        optionDiv.innerHTML = `
          <div class="flex items-center justify-center">
            <span class="text-3xl mr-4 bg-white bg-opacity-20 rounded-full w-12 h-12 flex items-center justify-center font-bold">
              ${String.fromCharCode(65 + index)}
            </span>
            <span>${option}</span>
          </div>
        `;
        opts.appendChild(optionDiv);
      });
    });

    socket.on("scoreUpdate", ({ scores, lastAnswerTime }) => {
      if (!scores || Object.keys(scores).length === 0) {
        sbArea.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <div class="text-4xl mb-4">üìä</div>
            <p class="text-lg">No scores yet.</p>
          </div>
        `;
        return;
      }
      
      const arr = Object.entries(scores).sort((a,b) => b[1] - a[1]);
      let html = "";
      
      arr.forEach(([player, score], index) => {
        const time = lastAnswerTime?.[player] ? `${lastAnswerTime[player]}s` : "-";
        let trophyIcon = "";
        let cardClass = "bg-gradient-to-r from-gray-100 to-gray-200 text-gray-800";
        
        if (index === 0) {
          trophyIcon = "ü•á";
          cardClass = "bg-gradient-to-r from-yellow-400 to-yellow-600 text-white";
        } else if (index === 1) {
          trophyIcon = "ü•à";
          cardClass = "bg-gradient-to-r from-gray-300 to-gray-500 text-white";
        } else if (index === 2) {
          trophyIcon = "ü•â";
          cardClass = "bg-gradient-to-r from-orange-400 to-orange-600 text-white";
        } else {
          trophyIcon = `${index + 1}`;
        }
        
        html += `
          <div class="${cardClass} rounded-xl p-4 shadow-lg">
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <span class="text-2xl mr-3 font-bold">${trophyIcon}</span>
                <div>
                  <div class="font-bold text-lg">${player}</div>
                  <div class="text-sm opacity-80">‚è±Ô∏è ${time}</div>
                </div>
              </div>
              <div class="text-2xl font-bold">${score}</div>
            </div>
          </div>
        `;
      });
      
      sbArea.innerHTML = html;
    });

    socket.on("questionEnded", (payload) => {
      // Update question display
      qText.innerHTML = `
        <div class="flex items-center justify-center text-green-600">
          <span class="text-6xl mr-6">‚úÖ</span>
          <span>Question Ended</span>
        </div>
      `;
      
      // Clear options
      opts.innerHTML = `
        <div class="text-center py-12 text-gray-500 col-span-full">
          <div class="text-6xl mb-4">üìä</div>
          <p class="text-xl">Check the leaderboard for results!</p>
        </div>
      `;
      
      socket.emit("requestScores");
    });
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ce7ec5230f7e6f',t:'MTc1NDgxODQ0My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
