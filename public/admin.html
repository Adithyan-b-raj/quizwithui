
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Quiz Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .question-btn {
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
    }
    .question-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3);
    }
    .end-btn {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      transition: all 0.3s ease;
    }
    .end-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
    }
    .score-card {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    .answer-item {
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .correct-answer {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    .wrong-answer {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
    }
  </style>
</head>
<body class="p-6">
  <div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="glass-card rounded-2xl p-8 mb-8 shadow-2xl">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">ðŸŽ¯ Quiz Admin Panel</h1>
      <p class="text-gray-600">Manage your live quiz session with real-time updates</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-8">
      <!-- Left Column -->
      <div class="space-y-8">
        <!-- Questions Section -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <div class="flex items-center mb-6">
            <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
            <h3 class="text-2xl font-semibold text-gray-800">Questions Library</h3>
            <span class="ml-auto bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium">Preloaded</span>
          </div>
          <div id="questionsList" class="space-y-4">
            <div class="flex items-center justify-center py-8">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
              <span class="ml-3 text-gray-600">Loading questions...</span>
            </div>
          </div>
        </div>

        <!-- Control Section -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <div class="flex items-center mb-4">
            <div class="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
            <h3 class="text-2xl font-semibold text-gray-800">Quiz Control</h3>
          </div>
          <button id="endBtn" class="end-btn w-full text-white font-semibold py-4 px-6 rounded-xl shadow-lg">
            ðŸ›‘ End Current Question
          </button>
        </div>
      </div>

      <!-- Right Column -->
      <div class="space-y-8">
        <!-- Live Scores -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <div class="flex items-center mb-6">
            <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
            <h3 class="text-2xl font-semibold text-gray-800">Live Scores</h3>
            <div class="ml-auto flex items-center">
              <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse mr-2"></div>
              <span class="text-sm text-green-600 font-medium">LIVE</span>
            </div>
          </div>
          <div class="score-card rounded-xl p-4 shadow-lg">
            <pre id="scores" class="text-sm font-mono whitespace-pre-wrap">Loading scores...</pre>
          </div>
        </div>

        <!-- Recent Answers -->
        <div class="glass-card rounded-2xl p-6 shadow-xl">
          <div class="flex items-center mb-6">
            <div class="w-3 h-3 bg-purple-500 rounded-full mr-3"></div>
            <h3 class="text-2xl font-semibold text-gray-800">Recent Answers</h3>
            <div class="ml-auto flex items-center">
              <div class="w-2 h-2 bg-purple-500 rounded-full animate-pulse mr-2"></div>
              <span class="text-sm text-purple-600 font-medium">LIVE</span>
            </div>
          </div>
          <div class="max-h-80 overflow-y-auto">
            <ul id="recentAnswers" class="space-y-2"></ul>
            <div id="noAnswers" class="text-center py-8 text-gray-500">
              <div class="text-4xl mb-2">ðŸ’­</div>
              <p>No answers yet. Waiting for players...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const qListDiv = document.getElementById("questionsList");
    const scoresDiv = document.getElementById("scores");
    const recentAnswers = document.getElementById("recentAnswers");
    const noAnswers = document.getElementById("noAnswers");
    const endBtn = document.getElementById("endBtn");

    let questions = [];

    socket.on("questionsList", (q) => {
      questions = q;
      renderQuestions();
    });

    function renderQuestions() {
      qListDiv.innerHTML = "";
      questions.forEach((q, idx) => {
        // Question container
        const container = document.createElement("div");
        container.className = "border border-gray-200 rounded-xl p-4 hover:border-purple-300 transition-colors";
        
        // Question button
        const btn = document.createElement("button");
        btn.className = "question-btn w-full text-white font-semibold py-4 px-6 rounded-xl shadow-lg mb-3";
        btn.textContent = `ðŸ“ ${q.text}`;
        btn.onclick = () => {
          if (!confirm("Send this question to players and projector?")) return;
          socket.emit("sendQuestion", idx);
        };
        container.appendChild(btn);

        // Options display
        const optionsContainer = document.createElement("div");
        optionsContainer.className = "bg-gray-50 rounded-lg p-3";
        
        const optionsLabel = document.createElement("div");
        optionsLabel.className = "text-sm font-medium text-gray-600 mb-2";
        optionsLabel.textContent = "Answer Options:";
        optionsContainer.appendChild(optionsLabel);
        
        const optionsGrid = document.createElement("div");
        optionsGrid.className = "grid grid-cols-2 gap-2";
        
        q.options.forEach((option, optIdx) => {
          const optionTag = document.createElement("span");
          optionTag.className = "bg-white px-3 py-1 rounded-lg text-sm border border-gray-200";
          optionTag.textContent = `${String.fromCharCode(65 + optIdx)}) ${option}`;
          optionsGrid.appendChild(optionTag);
        });
        
        optionsContainer.appendChild(optionsGrid);
        container.appendChild(optionsContainer);
        qListDiv.appendChild(container);
      });
    }

    socket.on("scoreUpdate", (s) => {
      scoresDiv.textContent = JSON.stringify(s, null, 2);
    });

    socket.on("answerUpdate", (a) => {
      // Hide "no answers" message
      noAnswers.style.display = 'none';
      
      const li = document.createElement("li");
      li.className = `answer-item p-3 rounded-lg shadow-sm ${a.correct ? 'correct-answer' : 'wrong-answer'}`;
      
      const playerName = document.createElement("span");
      playerName.className = "font-semibold";
      playerName.textContent = a.player;
      
      const arrow = document.createElement("span");
      arrow.className = "mx-2";
      arrow.textContent = "â†’";
      
      const option = document.createElement("span");
      option.textContent = a.option;
      
      const status = document.createElement("span");
      status.className = "ml-2 px-2 py-1 rounded-full text-xs font-medium bg-white bg-opacity-20";
      status.textContent = a.correct ? "âœ“ CORRECT" : "âœ— WRONG";
      
      li.appendChild(playerName);
      li.appendChild(arrow);
      li.appendChild(option);
      li.appendChild(status);
      
      recentAnswers.insertBefore(li, recentAnswers.firstChild);
      
      // Keep list short
      while (recentAnswers.children.length > 10) {
        recentAnswers.removeChild(recentAnswers.lastChild);
      }
    });

    endBtn.onclick = () => {
      socket.emit("endQuestion");
    };

    socket.on("questionEnded", (payload) => {
      // optionally show summary in admin
      console.log("questionEnded", payload);
    });
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96ce723e55ea7e6f',t:'MTc1NDgxNzkzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
